---
format_version: '8'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: ios

workflows:
  ci:
    steps:
    - cache-pull: {}
    - carthage:
        inputs:
        - carthage_options: "--platform iOS --cache-builds --use-ssh --project-directory
            Sources/BeagleUI/"
    - xcode-test:
        title: BeagleUIFrameworkTests
        inputs:
        - generate_code_coverage_files: 'yes'
        - simulator_device: iPhone XR
        - scheme: BeagleUI
    - codecov:
        inputs:
        - CODECOV_TOKEN: "$CODECOV_TOKEN"
    - cache-push: {}

  deploy:
    steps:
    - cache-pull@2.1.3: {}
    - certificate-and-profile-installer@1.10.2: {}
    - recreate-user-schemes@1.0.2:
        inputs:
        - project_path: "$BITRISE_PROJECT_PATH"
    - xcode-test@2.4.3:
        inputs:
        - project_path: "$BITRISE_PROJECT_PATH"
        - scheme: "$BITRISE_SCHEME"
    - xcode-archive@2.7.1:
        inputs:
        - project_path: "$BITRISE_PROJECT_PATH"
        - scheme: "$BITRISE_SCHEME"
        - export_method: "$BITRISE_EXPORT_METHOD"
    - deploy-to-bitrise-io@1.9.5: {}
    - cache-push@2.2.3: {}

app:
  envs:
  - opts:
      is_expand: false
    BITRISE_PROJECT_PATH: Darwin-BeagleUI.xcworkspace
  - opts:
      is_expand: false
    BITRISE_SCHEME: BeagleUI
  - opts:
      is_expand: false
    BITRISE_EXPORT_METHOD: development

meta:
  bitrise.io:
    machine_type: standard

